# ü§ñ AI Onboarding & Workplace Assistant ‚Äî Architecture Overview

**Scope:** Phase 1 (Chatbot with Bedrock + Knowledge Base) and forward-looking Phase 2 (Agent Mode with actions).  
**Channel:** Google Chat (1-to-1 DMs).  
**Stack:** Amazon Bedrock (KB + Guardrails), AWS Lambda, API Gateway, DynamoDB, S3 (+ optional Kendra), Secrets Manager, CloudWatch.

---

## 1Ô∏è‚É£ System Architecture (End-to-End)

```mermaid
flowchart LR
    subgraph GChat[Google Workspace]
      U[Employee (Google Chat DM)]
      GC[Google Chat App (Bot)]
    end

    subgraph GCP[GCP]
      GCW[Chat Webhook HTTPS Endpoint]
    end

    subgraph Edge[AWS Edge]
      APIGW[Amazon API Gateway]
    end

    subgraph AWSCore[AWS (Private VPC)]
      L1[Lambda: chat-webhook <br/>context enrich + routing]
      BR[Amazon Bedrock (Model + Guardrails)]
      KB[Bedrock Knowledge Base <br/>(S3 + optional Kendra)]
      DDB[(DynamoDB <br/>users / threads / logs)]
      SM[Secrets Manager]
      CW[CloudWatch Logs & Metrics]
      EB[EventBridge (optional schedulers)]
    end

    %% Future Phase 2
    subgraph Actions[Phase 2 ‚Äì Agent Mode (Optional)]
      AG[Bedrock Agent Action Group]
      L_SUBMIT[Lambda: access-submit]
      L_STATUS[Lambda: access-status]
      L_LIST[Lambda: access-list]
      EXT_IDP[(SailPoint / Okta / HRMS / etc.)]
    end

    %% Primary flow
    U --> |DM| GC
    GC --> |Webhook (signed)| GCW
    GCW --> APIGW
    APIGW --> L1
    L1 --> |Converse prompt| BR
    BR <-->|RAG retrieval| KB
    L1 --> DDB
    L1 --> CW
    SM --> L1

    %% Response
    L1 --> |formatted reply| APIGW --> GCW --> GC --> U

    %% Phase 2 actions
    BR --> |tool call| AG
    AG --> L_SUBMIT & L_STATUS & L_LIST
    L_SUBMIT --> |REST/OAuth| EXT_IDP
    L_STATUS --> |REST/OAuth| EXT_IDP
    L_LIST --> |REST/OAuth| EXT_IDP
    L_SUBMIT --> DDB
    L_STATUS --> DDB

    %% Monitoring
    EB --> L_STATUS
    L_STATUS --> CW


flowchart TB
    classDef boundary fill:#f3f6ff,stroke:#5b7fff,stroke-width:2px,corner-radius:6px;
    classDef high fill:#ffeaea,stroke:#ff6b6b,stroke-width:2px;
    classDef med fill:#fff9e6,stroke:#ffb200,stroke-width:2px;
    classDef low fill:#eefbf1,stroke:#2bb673,stroke-width:2px;

    subgraph B1[Boundary A: Google Workspace Tenant]
      U[End User]:::low
      GC[Google Chat Bot App]:::low
    end
    class B1 boundary;

    subgraph B2[Boundary B: Internet / Edge (TLS)]
      HTTPS[Signed HTTPS Webhook + API Gateway]:::med
    end
    class B2 boundary;

    subgraph B3[Boundary C: AWS Private VPC]
      L1[Lambda: chat-webhook]:::med
      BR[Amazon Bedrock + Guardrails]:::low
      KB[S3 / Kendra (KB)]:::med
      DDB[(DynamoDB)]:::med
      SM[Secrets Manager]:::high
      CW[CloudWatch Logs]:::med
      EB[EventBridge]:::low
    end
    class B3 boundary;

    subgraph B4[Boundary D: External Enterprise APIs (Phase 2)]
      IDP[(SailPoint / Okta / HRMS etc.)]:::high
    end
    class B4 boundary;

    U --> GC
    GC --> |Signed Webhook| HTTPS
    HTTPS --> L1
    L1 --> BR
    BR --> KB
    L1 --> DDB
    L1 --> CW
    SM --> L1

    %% Phase 2
    BR --> |Action Group| IDP
    SM --> IDP

    note right of L1
      Minimal user context (role, dept, region) <br/>No raw PII unless required
    end

    note right of SM
      Secrets / tokens (HIGH) <br/>KMS-encrypted & IAM-scoped
    end

    note left of KB
      Internal documents only <br/>Tagged by dept / region / sensitivity
    end


flowchart TB
    classDef boundary fill:#f3f6ff,stroke:#5b7fff,stroke-width:2px,corner-radius:6px;
    classDef high fill:#ffeaea,stroke:#ff6b6b,stroke-width:2px;
    classDef med fill:#fff9e6,stroke:#ffb200,stroke-width:2px;
    classDef low fill:#eefbf1,stroke:#2bb673,stroke-width:2px;

    subgraph B1[Boundary A: Google Workspace Tenant]
      U[End User]:::low
      GC[Google Chat Bot App]:::low
    end
    class B1 boundary;

    subgraph B2[Boundary B: Internet / Edge (TLS)]
      HTTPS[Signed HTTPS Webhook + API Gateway]:::med
    end
    class B2 boundary;

    subgraph B3[Boundary C: AWS Private VPC]
      L1[Lambda: chat-webhook]:::med
      BR[Amazon Bedrock + Guardrails]:::low
      KB[S3 / Kendra (KB)]:::med
      DDB[(DynamoDB)]:::med
      SM[Secrets Manager]:::high
      CW[CloudWatch Logs]:::med
      EB[EventBridge]:::low
    end
    class B3 boundary;

    subgraph B4[Boundary D: External Enterprise APIs (Phase 2)]
      IDP[(SailPoint / Okta / HRMS etc.)]:::high
    end
    class B4 boundary;

    U --> GC
    GC --> |Signed Webhook| HTTPS
    HTTPS --> L1
    L1 --> BR
    BR --> KB
    L1 --> DDB
    L1 --> CW
    SM --> L1

    %% Phase 2
    BR --> |Action Group| IDP
    SM --> IDP

    note right of L1
      Minimal user context (role, dept, region) <br/>No raw PII unless required
    end

    note right of SM
      Secrets / tokens (HIGH) <br/>KMS-encrypted & IAM-scoped
    end

    note left of KB
      Internal documents only <br/>Tagged by dept / region / sensitivity
    end